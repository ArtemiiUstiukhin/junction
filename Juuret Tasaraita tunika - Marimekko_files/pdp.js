!function(){var o,i,r,n;function t(){var t=document.createElement("script");t.setAttribute("src","//widget.fitanalytics.com/widget_zepto.js"),t.setAttribute("type","text/javascript"),document.body.appendChild(t),o.initialize(),window._fitAnalytics=window._upcload=function(){},window._fitAnalytics.shop=o}window._fitAnalytics||(o={prefix:"marimekko-",products:{},isMobile:/iphone|android|iemobile|blackberry/i.test(window.navigator.userAgent)&&"ontouchstart"in window,el:{productContainer:"#maincontent",sizes:".swatch-attribute-options .swatch-option",addToCart:"#product-addtocart-button",thumbnail:".slick-current.slick-active .pdp__media-grid-item .lazyload-image-wrapper > img",sizeChart:".size-chart__trigger",productSerial:"#product_addtocart_form",productSerials:".color-options .color-swatch"},hideSizeChart:!1,blockedLocales:[],initialize:function(){var t=setInterval(function(){o.isLoaded()&&(clearInterval(t),o.onLoaded())},100)},isLoaded:function(){return"function"==typeof window.FitAnalyticsWidget&&window.fitAnalyticsData&&document.querySelectorAll(o.el.sizes).length},isBlockedLocale:function(){var t=[o.getLanguage(),o.getCountry()].join("_");return-1<o.blockedLocales.indexOf(t)},onLoaded:function(){o.$=FitAnalyticsWidget.jQuery,o._=FitAnalyticsWidget._,o.isDataAvailable()&&!o.isBlockedLocale()&&o.onPageLoaded()},isDataAvailable:function(){var t=o.getCurrentSerial(),e=o.getSerials();return!(!t||!e.length)},getData:function(t,e){return void 0===e&&(e=""),n(window,"fitAnalyticsData."+t,e)},getOperations:function(){var t=o.getData("operations")||{};return new Proxy(t,{get:function(t,e){return t.hasOwnProperty(e)?t[e]:function(){}}})},getDOMAnchor:function(){return o.find(o.el.sizeChart)},getButtonAnchor:function(){return o.getOperations().getSizeChartLink()||o.getDOMAnchor()},find:function(t){return o.getContainer().find(t)},getContainer:function(){return o.$(o.el.productContainer)},getStyleId:function(){var t=o.find(o.el.styleIdselector).attr("id");return t&&r(t.split("size-grid-section-")[1])},getCurrentRawSerial:function(){var t=(window.dataLayer||[]).filter(function(t){return"productDetail"==t.event}).pop(),t=n(t,"ecommerce.detail.products.0.id","");return o.getData("currentProductId")||o.find(o.el.productSerial).attr("data-product-sku")||t},getCurrentSerial:function(){var t=o.getCurrentRawSerial();return t&&o.prefix+t},getRawSerials:function(){return[o.getCurrentRawSerial()]},getSerials:function(){return o.getRawSerials().map(function(t){return o.prefix+t})},getDOMSizes:function(){var i=[];return i.dic={},i.state={},o.find(o.el.sizes).toArray().forEach(function(t){var e=o.$(t),n=r(e.text()),t=!e.attr("data-product-outofstock");n&&(i.state[n]=t)&&(i.push(n),i.dic[n]=e)}),i},getSizes:function(){var t=o.getData("sizes",[]);return t.length?t:o.getDOMSizes()},getSelectedSize:function(){return o.find(o.el.sizes+".selected").text()},getLanguage:function(){return o.getData("shopLanguage")},getCountry:function(){return o.getData("shopCountry")},getThumbnail:function(){return o.getData("mainThumbnail")||o.find(o.el.thumbnail).attr("src")||""},getUserId:function(){return""},getSizeChart:function(){return o.find(o.el.sizeChart)},getContext:function(t){return o.products[t]},setContext:function(t,e){return o.products[t]=o._.extend({},o.products[t],e)},attachMetricsToSizeChart:function(){o.getSizeChart().off("click.fita").on("click.fita",function(){o.widget.meterClick("sizeChart",{garmentId:o.getCurrentSerial()})})},onPageLoaded:function(){o.loadWidget(),o.requestProducts(),o.attachMetricsToSizeChart()},loadWidget:function(){o.widget=new window.FitAnalyticsWidget({language:o.getLanguage(),shopCountry:o.getCountry(),userId:o.getUserId(),recommend:function(t,e,n){o.recommend(t,e,n)},cart:function(t,e,n){o.recommend(t,e,n),o.getSelectedSize()===e||o.getOperations().selectSize(e),i(o.getOperations().getAddToCartBtn())},close:function(t,e,n){o.recommend(t,e,n),o.button.find().focus()},open:function(){Object.keys(o.products).forEach(function(t){(o.products[t]||{}).recommendation=null})}})},requestProducts:function(){o.collectProducts();var t=Object.keys(o.products);o.widget.requestProducts(t,function(t){t.forEach(function(t){o.setContext(t.garment.serial,{isSupported:!0})}),o.checkForProductChange()})},collectProducts:function(){o.getSerials().forEach(function(t){o.setContext(t,{isSupported:!1})})},recommend:function(t,e,n){o.addRecommendationToContext(t,e,n),o.button.setText(e,n)},addRecommendationToContext:function(t,e,n){o.setContext(t,{recommendation:{size:e,details:n}})},checkForProductChange:function(){var e;setInterval(function(){var t=o.getCurrentSerial();e!==t&&(e=t)&&o.onProductChange()},200)},onProductChange:function(){o.reconfigure()},reconfigure:function(){var t=o.getCurrentSerial();o.widget.reconfigure({productId:t},o.onProductLoaded,o.onProductError)},onProductLoaded:function(){o.widget.meterProductVisit(o.getCurrentSerial(),!0),o.installButton()},onProductError:function(){o.widget.meterProductVisit(o.getCurrentSerial(),!1),o.button.hide(),o.getSizeChart().show()},installButton:function(){o.button.install(),o.button.show(),o.setRecommendation(),o.hideSizeChart&&o.getSizeChart().hide()},setRecommendation:function(){var t=o.getContext(o.getCurrentSerial());t.recommendation?o.button.setText(t.recommendation.size,t.recommendation.details):(t.recommendation=!0,o.getRecommendation())},getRecommendation:function(){o.widget.getRecommendation({productId:o.getCurrentSerial(),thumb:o.getThumbnail(),manufacturedSizes:o.getSizes().state})},button:{elementId:"fitanalytics__button",text:{bg:["Намери своя размер","Вашият размер е (size)"],ca:["Rebi una recomanació de talla","La seva talla és (size)"],cs:["Zjistěte svou velikost","Vaše velikost je (size)"],da:["Find din størrelse","Din størrelse er (size)"],de:["Finde deine Größe","Deine Größe ist (size)"],el:["Βρες το μέγεθός σου","Το μέγεθός σου είναι (size)"],en:["Find your size","Your size is (size)"],es:["Encuentra tu talla","Tu talla es (size)"],fi:["Löydä oma kokosi","Sinun kokosi on (size)"],fr:["Trouver ma taille","Votre taille est (size)"],hr:["Pronađite svoju veličinu","Vaša veličina je (size)"],hu:["Találd meg a méreted","A méreted (size)"],it:["Trova la tua taglia","La tua taglia è (size)"],ja:["サイズを見つけましょう","あなたのサイズ： (size)"],ko:["사이즈 찾기","고객님의 사이즈는 (size) 입니다"],mk:["Пронајдете ја својата големина","Вашата големина е (size)"],nl:["Vind jouw maat","Jouw maat is (size)"],no:["Finn størrelsen din","Størrelsen din er (size)"],pl:["Znajdź mój rozmiar","Twój rozmiar to (size)"],pt:["Encontrar seu tamanho","Seu tamanho é (size)"],ro:["Găsește-mi mărimea","Mărimea dvs. este (size)"],ru:["Найдите свой размер","Ваш размер (size)"],sk:["Zistite svoju veľkosť","Vaša veľkosť je: (size)"],sl:["Poiščite svojo velikost","Vaša velikost je (size)"],sv:["Hitta din storlek","Din storlek är (size)"],tr:["Size uyan bedeni bulun","Sizin bedeniniz (size)"],zh:["找到您的尺寸","您的尺寸是 (size)"]},getText:function(e,t){var n=o.getData("sizes",[]).filter(function(t){return t.value===e}).pop(),n=!("string"!=typeof e||!(n&&n.isAvailable||o.getDOMSizes().state[e])||t.outOfStock||t.outOfRange),t=this.text[o.getLanguage()]||this.text.en;return(n?t[1].replace("(size)","<b>"+e+"</b>"):t[0]).toUpperCase()},setText:function(t,e){this.find().find(".fitanalytics__button-text").html(this.getText(t,e)),this.find().attr("aria-label",this.getText(t,e).replace(/<\/?b>/g,""))},buildButton:function(){var t=this.getText();return o.$("<a></a>").attr({id:this.elementId,tabindex:"0",role:"button","aria-label":this.getText()||this.text.en}).css({cursor:"auto","margin-top":"10px","margin-bottom":"10px",display:"inline-block",width:"auto"}).on("keypress",this.onKeyboardPress).on("click",this.onClick).append(o.$("<span></span>").attr({class:"fitanalytics__button-text"}).css({display:"inline-block","border-bottom":"1px solid black",cursor:"pointer","vertical-align":"top","font-size":"1.1rem","font-weight":"400",color:"black","line-height":"21px",height:"19px","letter-spacing":".075em"}).text(t)).append('<style type="text/css">\n                #fitanalytics__button:focus {\n                  outline: 1px black dotted !important;\n                  outline-offset: 2px;\n                }\n              </style>')},show:function(){this.find().show()},hide:function(){this.find().hide()},find:function(){return o.find("#"+this.elementId)},onClick:function(){return o.widget.meterClick("sizeAdvisor",{garmentId:o.getCurrentSerial()}),o.widget.open({productId:o.getCurrentSerial(),thumb:o.getThumbnail(),manufacturedSizes:o.getDOMSizes().state}),!1},onKeyboardPress:function(t){t.preventDefault();t=t.which;13!==t&&32!==t||o.button.onClick()},install:function(){var t,e;this.find().length||(t=this.buildButton(),e=o.$("<a> | </a>"),o.$(o.getButtonAnchor()).after(e.add(t)))}}},i=function(t){return!(!t||!o.$)&&("function"==typeof(t=!(t instanceof o.$||o.$.zepto&&o.$.zepto.isZ(t))?o.$(t):t).prop&&"OPTION"===t.prop("tagName")?t.parent().val(t.val()).change():"function"==typeof t.click&&t.click(),t)},r=function(t){return"string"!=typeof t?"":t.replace(/^["'\s\uFEFF\xA0]+|[\s\uFEFF\xA0"']+$/g,"")},n=function(t,e,n){t=t&&t instanceof Object?t:{},null==n&&(n=null),"."===e&&(e="");for(var i="[object Array]"===Object.prototype.toString.apply(e)?e:e.split("."),o=0,r=i.length;o<r;o++){var a=t[i[o]];if(null==a)return n;t=a}return a},"interactive"===document.readyState||"complete"===document.readyState?t():document.addEventListener("DOMContentLoaded",function(){t()}))}();
//# sourceMappingURL=pdp.js.map